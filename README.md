# Олимпиада Mark.Online — подробная документация

Этот репозиторий содержит одностраничную фронтовую игру для проведения занятия по мотивам «Олимпиады». Проект полностью статический: HTML, CSS, JavaScript и файлы с конфигурацией лежат в корне. Игра запускается локально через любой статический сервер или прямо с GitHub Pages.

## Быстрый старт

1. Откройте `index.html` в браузере или запустите локальный сервер:
   ```bash
   python -m http.server 8000
   ```
2. Перейдите в браузере на `http://localhost:8000`.
3. На стартовом экране выберите сезон (Зимняя/Весенняя олимпиада) и затем программу.
4. После выбора отображается игровое поле и панели управления.

## Логика выбора поля и вариантов

Выбор теперь двухэтапный:

1. **Сезон**: Зимняя Олимпиада или Весенняя Олимпиада.
2. **Программа**:
   - Для **зимней** доступны: `J3`, `J4`
   - Для **весенней** доступны: `J3`, `J4`, `P3`

Итого получается **5 вариантов**:

- `winter-j3`
- `winter-j4`
- `spring-j3`
- `spring-j4`
- `spring-p3`

Для каждого варианта есть собственные редактируемые параметры в `config.json` и `board.json`.

## Структура проекта

```
/
├─ index.html        # Разметка страницы и меню выбора сезона/программы
├─ styles.css        # Стили интерфейса и игрового поля
├─ app.js            # Логика игры, UI и управление состоянием
├─ config.json       # Коэффициенты и стоимости команд для каждого варианта
├─ board.json        # Структура поля, герои, объекты и «надзиратель» для каждого варианта
├─ pictures/         # Графика персонажей и объектов
└─ ТЗ/               # Техническое задание и референсные материалы
```

## Конфигурация вариантов (`config.json`)

Файл `config.json` содержит редактируемые параметры для каждого варианта игры, включая список доступных команд и правила открытия. Структура:

```json
{
  "variants": {
    "winter-j3": {
      "label": "Зимняя Олимпиада — J3",
      "commands": [
        { "id": "up", "label": "Вверх", "type": "move" }
      ],
      "stageRules": [
        {
          "id": "stage1",
          "label": "Первая команда",
          "commands": ["up"]
        }
      ],
      "coefficients": {
        "stage1": 115,
        "hero": 200,
        "final": 800
      },
      "commandCosts": {
        "up": 150,
        "left": 350,
        "right": 400,
        "down": 500,
        "jump": 600,
        "hero": 0,
        "storage": 0,
        "box": 0
      }
    }
  }
}
```

### Что можно редактировать

- **commands** — полный список команд, которые доступны в этом варианте (используется для UI и стоимости).
- **stageRules** — правила открытия команд по порогам баллов.
- **coefficients** — коэффициенты для расчёта порогов:
  - `stage1`: первый этап (умножается на количество учеников)
  - `hero`: получение героя
  - `final`: финальный этап
- **commandCosts** — стоимость каждой команды на 1 ученика (умножается на количество учеников).

### Как добавить/изменить вариант

1. Добавьте новый ключ в `variants`, например `winter-j5`.
2. Укажите `label`, `coefficients`, `commandCosts`.
3. Обновите массивы доступных программ в `app.js` (см. блок `seasonPrograms`).

## Конфигурация поля (`board.json`)

`board.json` отвечает за визуальную структуру игрового поля и положение объектов. Структура каждого варианта:

```json
{
  "variants": {
    "winter-j3": {
      "grid": {
        "columns": 10,
        "rows": 8,
        "path": [{ "x": 1, "y": 6 }, { "x": 2, "y": 6 }],
        "start": { "x": 1, "y": 6 },
        "stone": { "x": 6, "y": 3 },
        "box": { "x": 7, "y": 3 }
      },
      "heroes": [
        { "id": "vector", "name": "Вектор", "img": "pictures/vector.png", "position": { "x": 2, "y": 2 } }
      ],
      "overseer": {
        "name": "Плохишиш",
        "img": "pictures/BADSHISH-3.png",
        "caption": "Вам не победить меня!"
      }
    }
  }
}
```

### Что можно редактировать

- **grid.path** — массив клеток пути. Каждая клетка задаётся координатами `x`, `y`.
- **grid.start** — стартовая позиция робота.
- **grid.stone** — позиция камня (препятствие).
- **grid.box** — позиция ящика.
- **grid.lock** — позиция замка на ящике.
- **heroes** — массив героев, их имена, картинки и координаты.
- **overseer** — параметры Плохишиша (он отображается *над* полем, не на сетке).

### Координаты

Координатная система начинается с (1,1) в левом верхнем углу сетки.
Каждая следующая клетка по `x` идёт вправо, по `y` — вниз.

## Управление состоянием

Состояние игры хранится в `localStorage`:

- выбранный вариант (`selectedVariant`)
- позиция робота
- открытые герои
- доступные команды
- текущая программа
- баллы, количество учеников

Кнопка **«Сбросить прогресс»** очищает состояние и возвращает игру в начальное состояние для выбранного варианта.

## Где что находится в коде

- **Меню выбора сезона/программы** — `index.html` (блок `.menu`) и обработчики в `app.js` (функции `showSeasonSelection`, `showProgramSelection`).
- **Игровое поле** — `renderBoard()` в `app.js`, данные берутся из `board.json`.
- **Стоимость команд** — `renderCommandCosts()` в `app.js`, данные берутся из `config.json`.
- **Плохишиш как наблюдатель** — `renderOverseer()` в `app.js` и стили `.overseer` в `styles.css`.

## Советы по редактированию

1. **Хотите поменять расположение клеток или героев?**  
   Редактируйте `board.json` в нужном варианте.

2. **Нужно изменить стоимости команд или коэффициенты?**  
   Меняйте `config.json` в нужном варианте.

3. **Добавляете новый сезон или программу?**  
   - Добавьте вариант в `config.json` и `board.json`.
   - Обновите список в `app.js` внутри `seasonPrograms`.

## Частые вопросы

**Почему Плохишиш не на поле?**  
По требованиям, Плохишиш — «надзиратель» и должен находиться над полем. Его блок рендерится отдельно (`.overseer`).

**Можно ли полностью изменить поле для каждого варианта?**  
Да. Каждый вариант имеет собственный набор данных в `board.json`.

**Можно ли иметь разные стоимости команд для каждого варианта?**  
Да. `commandCosts` задаются отдельно в каждом варианте `config.json`.
